<!DOCTYPE>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
<script type="text/javascript">
  window.onload = function() {
      var obj = document.getElementsByTagName('input');
      for(var i = 0; i < obj.length; i ++) {
          if (obj[i].type.toLowerCase() == 'button') {
              obj[i].onmouseover = function() {
                  this.style.backgroundColor = '#900';
                  this.style.color = '#FFF';
              }
              obj[i].onmouseout = function() {
                  this.style.backgroundColor = '';
                  this.style.color = '';
              }
          }
      }
      var buttonR = document.getElementById('buttonR')
      var buttonL = document.getElementById('buttonL')
      buttonR.onchange = function(e){
        console.log('text111',this.files,e);
        PureComponent(
          {
            "type": "Import",
            "elements": this,
          }
        ).then(res => {
          console.log('获取上传的数据===》》》',res);
        }).catch(error => {
          console.log('err==》》',error);
          }
        );
        // var types = obj.type || null,  // 导入Excel('Import')返回两项数据[{}],boolean/导出Excel('export'),返回boolean
        // elements = obj.elements || null, // input上传后的dom元素;
        // dataList = obj.dataList || null,  // 要导出Excel的数据, 格式：[{}]
        // textName = obj.textName || null,  // 要导出Excel文件名
        // fileTypes = obj.fileTypes,  // 自定义文件类型
        // judges = false;
      }
      buttonL.onclick = function(){
        console.log('text22');
        var list = [
          {
            "aaaa": 'jgdkjg',
            "bbbb": 'hfjhhghdfkg'
          },{
            "aaaa": 'jgdkjg',
            "bbbb": 'hfjhhghdfkg'
          }
        ]
        PureComponent(
          {
            "type": "export",
            "dataList": list,
            "textName": '获取所有数据',
            // "fileTypes": 'xls',
          }
        ).then(res => {
          console.log('下载所有数据==》》',res);
        }).catch(error => {
          console.log('err==》》',error);
          }
        );
      }
  }

</script>
<script src="./index.js"></script>
</head>
 
<body>
  <input type="file" name="" id="buttonR" value='上传文件'/>
  <input type="button" id="buttonL" value="下载文件" />
</body>
</html>