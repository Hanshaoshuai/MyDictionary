<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="apple-mobile-web-app-capable" content="yes"/>
	    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
	    <meta name="format-detection" content="telephone=no"/>
	    <meta name="format-detection" content="email=no"/>
	    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no">
	    <meta name="data-bizType" content="MYBANKAPP"/>
	    <meta name="data-aspm" content="a290"/>
		<title></title>
		<link rel="stylesheet" type="text/css" href="record.css"/>
		<style type="text/css">
		</style>
		<script>
			var ua = navigator.userAgent.toLowerCase();
	        !function(e){function t(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=window;t["default"]=i.vl=function(e,t){var n=e||100,r=t||750,a=i.document,d=navigator.userAgent,o=d.match(/Android[\S\s]+AppleWebkit\/(\d{3})/i),l=d.match(/U3\/((\d+|\.){5,})/i),s=l&&parseInt(l[1].split(".").join(""),10)>=80,u=a.documentElement,c=1;if(o&&o[1]>534||s){u.style.fontSize=n+"px";var p=a.createElement("div");p.setAttribute("style","width: 1rem;display:none"),u.appendChild(p);var m=i.getComputedStyle(p).width;if(u.removeChild(p),m!==u.style.fontSize){var v=parseInt(m,10);c=100/v}}var f=a.querySelector('meta[name="viewport"]');f||(f=a.createElement("meta"),f.setAttribute("name","viewport"),a.head.appendChild(f)),f.setAttribute("content","width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1");var h=function(){u.style.fontSize=n/r*u.clientWidth*c+"px"};h(),i.addEventListener("resize",h)},e.exports=t["default"]}]);
	        // 设置基础字体大小及字体缩放比例
	        if(ua.match(/iPad/i)!="ipad") {
	        	vl(100, 750);
		   	}else{
		   		vl(100, 1024);
		   	}
			if(navigator.userAgent.indexOf("iPad") == -1){  
		    	vl(100, 750);
			}else{
		   		vl(100, 1024);
		   	}
	    </script>
	</head>
	<body>
		<div class="wrap big" id="J_wrap">
			<div class="shuaXin"><span>下拉刷新</span></div>
			<div class="content">
			    <div class="banner">
			    		<p>狗年旺旺分获得记录</p>
			    	</div>
			    <div class="content_button" data-aspm="c9526">
			    	<div class="first">日期</div>
			        <!--<div class="laste laste_border">活期金额(元)</div>-->
			        <div class="first">旺旺分</div>
			        <div class="laste">备注</div>
			    </div>
			    <div class="list">
				    	<ul>
				    		<!--<li>
				    			<p class="first">12月20日</p>
				    			<p class="laste">10,124.00<span></span></p>
				    			<p class="first">+1246.00</p>
				    			<p class="laste">3255.00<span></span></p>
				    		</li>-->
				    	</ul>
		    		</div>
		    </div>
		    <div class="jiaZai"><span>上拉加载</span></div>
		</div>
		<script src="index.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			List= [{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				},{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				},{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				},{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				},{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				},{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				},{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				},{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				},{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				},{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				},{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				},{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				},{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				},{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				},{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				},{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				},{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				},{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				},{			//查询积点消费发放记录接口
					"bizDate":"2018年5月11号", 		// /** 业务日期 */
				    "amount":"1000.00", 		///** 交易金额和币种   */
					"delta":"1000.00", 			//余额变动数量
					"pointCount":"20000.00", 			///** 积分个数 */
					"memo":"兑换红包" 			//事件原因
				}]
			let datelist= [],			//列表数据			
			    pageNum= 1,				//请求列表页数
			    dataLength=null,			//列表的总长度
			    setTime=null,
			    returns=false,
			    scrollTop=0,
			    clientHeight=window.innerHeight, // 设备窗口的高度（不会变）,
			    scrollHeight=null,
			    jiLuScrollTop=null,
			    x=0;
			function getObjXy(obj,documentBox){
			    var xy = obj.getBoundingClientRect();
			    var top = xy.top//-document.documentElement.clientTop+document.documentElement.scrollTop,//document.documentElement.clientTop 在IE67中始终为2，其他高级点的浏览器为0
			        bottom = xy.bottom,
			        left = xy.left-document.documentElement.clientLeft+document.documentElement.scrollLeft,//document.documentElement.clientLeft 在IE67中始终为2，其他高级点的浏览器为0
			        right = xy.right,
			        width = xy.width||right - left, //IE67不存在width 使用right - left获得
			        height = xy.height||bottom - top;
			
			    return {
			        top:top,
			        right:right,
			        bottom:bottom,
			        left:left,
			        width:width,
			        height:height
			    }
			}
			function imgeSrc(){
				let imges= document.querySelectorAll('.imges');
	    			let length= imges.length;
	    			for(let i=0; i<length; i++){
	    				let test = getObjXy(imges[i]).top;
//	    				console.log(clientHeight)
	    				if(test<clientHeight){
	    					imges[i].src=imges[i].getAttribute('url');
	    				}
	    			}
//				console.log("top:" + test.top + ", right:" + test.right + ", bottom:" + test.bottom + ", left:" + test.left);
			}
			function domalert(rpc){
				alert(rpc)
			}
			const page = {
			    init() {
			    	this.iscroll()
					this.pushHtml();
			    },
			    iscroll(){
		    		uitan(dataLength,pageNum,this.pushHtml,'.big');
		    		const box= document.getElementById('J_wrap');
		    		window.addEventListener('scroll', ()=> {
						scrollTop = window.scrollY; 						// 当前滚动条位置    
					    clientHeight = window.innerHeight; 				// 设备窗口的高度（不会变）    
					    scrollHeight = document.body.scrollHeight; 		// 滚动条总高度 
//					    console.log(scrollTop + clientHeight+'=='+scrollHeight)
		    			if(scrollHeight-(Math.floor(scrollTop + clientHeight))<18 || scrollHeight-(Math.ceil(scrollTop + clientHeight))<18){
		    				if(x==0){
		    					x+=1;
	//			    			console.log(scrollTop + clientHeight+'=='+scrollHeight)
			    				document.querySelector('.jiaZai').innerText='加载中';
			    				setTime=setTimeout(()=> {
			    					this.pushHtml();
			    				},10)
		    				}
		    			}
		    			if(scrollTop>jiLuScrollTop){
		    				imgeSrc();
		    			}
		    		})
			    },
			    pushHtml(){
		    		clearTimeout(setTime);
		    		x=0;
		    		if(dataLength!=pageNum-1){
				    	let thmlList='';
//					    	console.log(pageNum);
			    		for(var key in List){
				    		thmlList+="<li id='li"+key+"'>"+
				    			"<p class='first'>"+List[key].bizDate+"<font></font></p>"+
				    			"<p class='first'>"+List[key].pointCount+"<font></font></p>"+
				    			"<p class='laste'>"+List[key].memo+"<font></font></p>"+
				    			"<img onclick=domalert('woshi'+"+key+") style='width:100px;height:50px;background:#00C2C2;' class='imges'url='./slide4.png'>"+
				    		"</li>"
				    	}
				    let dom= document.querySelector('.list ul');
				    let domDiv= document.createElement('div');
				    	domDiv.innerHTML=thmlList;
				    	dom.appendChild(domDiv);
				    	imgeSrc();
				    	pageNum+= 1;
				    	dataLength=66;
				    	jiLuScrollTop=window.scrollY;
					}else{
						document.querySelector('.jiaZai').innerText='没有更多数据';
					}
			    },
			}
			window.onload=function(){
				page.init();
			}
		</script>
	</body>
</html>
